# pki

## Tree
```
.
│   demo.go
│   gen.go
├───accesscontrol
│       ca.go
│       ca_test.go
├───common
│   ├───nacl
│   │   └───sign
│   │           sign.go
│   │           sign_test.go
│   │
│   └───rsa
│           rsa.go
│           rsa_test.go
└───release
        ca_root_crt.pem
        ca_root_private.pem
        ed25519_private.pem
        ed25519_public.pem
        rsa_private.pem
        rsa_public.pem
```
## QUICK START

1. go run gen.go
```
Creating RSA Keypair...
-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQDDAtxIQiaLT52Qvd5BfXruJ7swfZ8Ezgt9yu70If0Rytg2jgbz
TRZIGwyC19+YT94FPoSw7BlrCQ8iKiKnr+CkcGKKJrwtxK7I+SIzBogLKmiqJsoQ
3kmrPNuBmCfFO4KGfUDQQreVghGJHeB1Z1bYyBrXzcv3CJqPjdGmDnHPFwIDAQAB
AoGAIu+3QSbAuwKHau/pCniNdm8dxQEsZPL48g9SIeCY8wARHizxp9Luo/pcknBU
OXhNgUkDAqM5pohX8rnzvXDv4JUq1JqVK15x3c46VQaNLxSL5qPFIuVAaIartxXA
zYNXqfkt0G/D3JatyzgV5Ow9WFURVP8XRNDyTPODD0LwRMECQQDFgkYvusknnZ0g
pVQcaaZb+eItOh29luNTBeQB3siJmpWv81Xa5D1iokJCj6Y+AXcqJPgI1NYo55G8
tn8MN/ehAkEA/MM6RmBv+1eXr5Shq3ixIENouHuBQlXQU/iB15y1WWv6duuLEqy4
xJHAQ34NXXuRwEmDOWoUrkRh4RD5kb/rtwJAGuBNWLVcJg3mkcitl2gxARcR1gGw
hln/+Q42JqMAOulUMSs1paGlUMSvq4sMnido5c0+C0WbFtncFQfoZes/wQJBAIfJ
PVonXqEwyi0p9LwQR19ktzI8LxF61kL2ApLY/dd/GXufSAQNQ+ldv2LCqd1pj8Az
/cnvQhLoa4ikPN5esvsCQHeC25D1IEgMUKgrGBBibqavq6OiN+bjlX1EUqgbfbeA
EGzcKzv8U494KDQbkWli/hi3i+cOmCt77EVZvoH7JeI=
-----END RSA PRIVATE KEY-----

-----BEGIN RSA PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDDAtxIQiaLT52Qvd5BfXruJ7sw
fZ8Ezgt9yu70If0Rytg2jgbzTRZIGwyC19+YT94FPoSw7BlrCQ8iKiKnr+CkcGKK
JrwtxK7I+SIzBogLKmiqJsoQ3kmrPNuBmCfFO4KGfUDQQreVghGJHeB1Z1bYyBrX
zcv3CJqPjdGmDnHPFwIDAQAB
-----END RSA PUBLIC KEY-----

Creating Ed25519 Keypair...
-----BEGIN ED25519 PRIVATE KEY-----
ypmFsWmcMtgNPN/+ditmHDvOUE1SH4esr5Dlu1erkgxM1wpBxv0NxnKzEKn7fu5I
lzc/0Zm4GPhBMSU29H2VGQ==
-----END ED25519 PRIVATE KEY-----

-----BEGIN ED25519 PUBLIC KEY-----
TNcKQcb9DcZysxCp+37uSJc3P9GZuBj4QTElNvR9lRk=
-----END ED25519 PUBLIC KEY-----

Creating CA ROOT crt and private key...
-----BEGIN CERTIFICATE-----
MIICuTCCAiKgAwIBAgIIZBM57pyzsakwDQYJKoZIhvcNAQELBQAwaDELMAkGA1UE
BhMCQ04xEDAOBgNVBAgTB0JlaWppbmcxEDAOBgNVBAcTB0hhaWRpYW4xETAPBgNV
BAoTCGppaGFvLUNBMQ0wCwYDVQQLEwRidWFhMRMwEQYDVQQDEwp3d3cuY2EuY29t
MB4XDTE4MDYxNDA5MTYxOFoXDTM4MDYxNDA5MTYxOFowaDELMAkGA1UEBhMCQ04x
EDAOBgNVBAgTB0JlaWppbmcxEDAOBgNVBAcTB0hhaWRpYW4xETAPBgNVBAoTCGpp
aGFvLUNBMQ0wCwYDVQQLEwRidWFhMRMwEQYDVQQDEwp3d3cuY2EuY29tMIGfMA0G
CSqGSIb3DQEBAQUAA4GNADCBiQKBgQDN1ZYWCN3+P3+zmOx2nGs75Wobgzs4H/Sk
k7h8S5kYIfa/v71z7dH3qC+c8p0FrnMn10fGSrAaAHXfwtkn4TAqJCOHKAvKr702
ZHIwg/DhZkz54rcbslAOHEMuUspCECkdI3INC1PXyl0adjr2qRy82aQbEvCwEm8v
tSwtfktwxwIDAQABo2wwajAOBgNVHQ8BAf8EBAMCAoQwHQYDVR0lBBYwFAYIKwYB
BQUHAwIGCCsGAQUFBwMBMA8GA1UdEwEB/wQFMAMBAf8wKAYDVR0RBCEwH4IKd3d3
LmNhLmNvbYERamloYW9AYnVhYS5lZHUuY24wDQYJKoZIhvcNAQELBQADgYEAHfIQ
ETjLR0WbpU9eYD5+1igfLt2GID1QHlD25w4aCD++AYSjgfdvSq0f/hjcJAiUKr2f
Nda7tq0nlpN6YnQOENQ6FLhispAiz0n7Yk/cKAwEhrtju7EL+qW3TsZ3PQ9D5OBK
eb2eTJ3F45lT3p4zCMum9ScPxMkk2qnmRPInDCM=
-----END CERTIFICATE-----

-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQDN1ZYWCN3+P3+zmOx2nGs75Wobgzs4H/Skk7h8S5kYIfa/v71z
7dH3qC+c8p0FrnMn10fGSrAaAHXfwtkn4TAqJCOHKAvKr702ZHIwg/DhZkz54rcb
slAOHEMuUspCECkdI3INC1PXyl0adjr2qRy82aQbEvCwEm8vtSwtfktwxwIDAQAB
AoGAJahL2yAoLRnE7UCvEkwvujeQoBP0Q6JlCa8U83iJO8cK863KpWj/HwYgH+Cr
JZzy6HkUYozLhxZKenOVcxxZySfbcFoNwJmNfXiKgBHM+QOWS+2EMN7TSyE8lQHK
1eMpckNiXchVO/iFNLwRkce19HSJYgfVDOvHAdgEGARRXaECQQDbgMQ6YvsMN235
+HzAYUcHfUaSuPOY2cQ03zRQi01L3cwC3ZgnMBmDlrR27ssrqcWizjXACz8IjqvP
XXMp8u0JAkEA8A8B1vCJc3sK8gNRitSBzfrh/XJiR+sqa8YO97OrEA/uKx0qD9hT
GVt85rHN8dxvy3xLWzM6nkTUthFXuJ+zTwJAQrfQ7S5IwF3Yv7IXuSHYRR5+5Pny
kPMgADIX5KNyyyyPZg+Uv9SO7MBR+hR7DLp9qA6lp8nDTwaOkmkFKCr+gQJAelEb
PdrIHohWVmQse1G2Zi7sUYij3UNNFScQ31Oz2PZVA7DTislN5kDAjoeQiSkp6YQG
nYyn1Jb7z11c1hzBbwJBAIlGjyl8KKdhh60qFOsZW6s27Jnpwnc/MylyPIHup3zi
X7+QWYW1ZQsXnJ2OU56UXwwAz0QdWBr/DUfRSKQQlzM=
-----END RSA PRIVATE KEY-----
```

2. go run demo.go
```
 ____    _____      _      ____    _____
/ ___|  |_   _|    / \    |  _ \  |_   _|
\___ \    | |     / _ \   | |_) |   | |
 ___) |   | |    / ___ \  |  _ <    | |
|____/    |_|   /_/   \_\ |_| \_\   |_|

===================== RSA DEMO(encrypt,decrypt) =====================
origin msg  : The State Council decided last Wednesday
encrypt  >> : [108 85 53 115 106 46 169 183 204 252 223 129 57 134 145 187 108 90 49 210 1 105 121 215 142 142 228 164 114 66 135 140 227 59 12 74 116 84 251 83 234 27 160 175 219 74 179 163 242 79 187 251 53 164 218 83 29 228 50 35 160 216 201 10 3 199 171 117 238 198 228 18 166 217 192 253 61 143 129 71 173 186 116 140 61 192 31 241 166 138 73 60 146 117 199 179 164 59 167 103 79 1 185 244 236 66 1 194 166 150 25 22 86 110 192 18 139 218 88 140 83 103 163 215 129 77 40 29]
b58 cipher  : C5ySowjvnU3TG8qMpAWGcaBYf59msgVbxtcfZ29BfBVKhGypFPg8Gsu49Suq6YM8YA8VnDTX4YpG9ncbpDJregA6LwERCSndv57br8vLx4zjCyFjCBXN2KWj9nNoai2A7ubdptuUHPnsYmMVC27pCE7F2FwHxCqzCw5Fgk6q3iFQms2
decrypt  >> : The State Council decided last Wednesday
*decrypt*>> :  crypto/rsa: decryption error
===================== RSA DEMO(sign,veryfy) =====================
sign       >> : [135 192 112 109 35 196 49 241 239 55 138 252 32 5 52 45 217 155 19 11 218 181 51 229 52 229 222 63 204 105 233 157 143 185 107 58 175 229 217 82 3 189 13 34 0 247 122 19 213 156 201 23 30 146 26 3 248 152 187 106 60 34 19 100 116 227 21 189 228 32 58 92 100 147 164 157 251 109 67 85 225 236 60 152 162 194 107 86 81 251 184 109 84 216 192 24 66 67 248 200 202 202 217 172 186 96 128 239 186 58 181 76 108 244 141 141 218 243 134 41 172 231 104 178 9 155 161 3]
b58 signature : Eti6xBhJB6SqiWwbHGZ6gCicscP637qCi7bzXDVdgQgfSXrVHYy3Po4uMsVKPBQuwfdZa5EH2StU9NjvoiSwEWv5xPpdyTgrupZaPPzXK4HjZwqBDS7GyN9qMb1wuWr4X3L2aW3z4Xq2EfLTmJ2cVxcEmNasczsyQ595LzhV6hRmbRk
verify     >> : true
*verify*   >> : false crypto/rsa: verification error
===================== ED25519 DEMO(sign,verify) =====================
origin msg  : President Trump meets Kim Jong-un
sign       >> : [69 164 45 30 34 183 177 82 42 38 126 132 22 56 2 8 94 205 237 35 201 59 12 57 92 117 116 40 66 254 10 253 199 127 112 232 128 112 61 239 156 188 28 94 14 221 104 196 21 52 211 244 233 5 70 17 94 207 26 160 227 176 237 14 80 114 101 115 105 100 101 110 116 32 84 114 117 109 112 32 109 101 101 116 115 32 75 105 109 32 74 111 110 103 45 117 110]
b58 signature : 2ptMoUjZwNBPEftPrZAfmxcwhH2dKNSxLMQiYbe2sNHBvq4BGovZYAJPaHNPDUoXKcLxq4wZpmxPyUwLa2pTLLNmo1DaMkNkiR13bt6Z76juW3eN2Siq65vuoBi8uaeMxCT73
verify     >> : true
*verify*   >> : false
===================== CA DEMO(gen,verify) =====================
org information         : {[UK] [overwatch] [darkwatch] [tracer@overwatch.com] [England] [London] www.overwatch.com true [www.overwatch.com]}
gen org private key  >> : &{RSA PRIVATE KEY map[] [48 130 2 93 2 1 0 2 129 129 0 191 99 144 111 179 108 139 12 249 25 12 63 111 34 237 137 113 7 213 5 63 108 209 87 67 37 104 74 165 216 48 181 93 229 136 31 182 153 101 182 99 120 68 32 73 127 206 100 221 168 166 221 148 205 137 27 210 76 159 230 239 13 64 28 32 221 186 110 108 99 131 62 115 162 140 77 206 50 48 245 120 232 208 132 165 11 134 104 175 95 92 20 207 249 223 93 226 112 80 171 199 9 161 207 212 64 45 134 225 241 63 206 161 181 12 85 253 27 175 17 149 104 48 229 90 81 2 33 2 3 1 0 1 2 129 128 118 80 84 127 217 9 102 196 116 81 57 179 21 63 32 92 240 213 8 169 31 214 99 107 112 132 245 126 0 28 47 176 79 5 144 43 26 180 165 158 36 203 186 65 195 110 16 231 101 231 214 143 240 103 71 53 61 194 68 175 124 100 82 150 126 232 27 130 22 221 193 27 100 175 3 126 120 255 27 217 10 82 174 153 232 153 160 155 17 83 64 71 48 187 142 89 142 201 214 114 123 97 161 134 100 164 161 51 214 49 215 79 169 143 33 221 227 79 68 34 59 48 108 182 95 131 125 97 2 65 0 233 32 152 113 130 126 51 221 133 131 76 133 87 245 79 138 128 25 74 106 95 48 38 82 33 129 189 216 98 155 115 190 95 17 72 107 231 107 205 176 88 45 236 64 217 135 17 145 103 112 244 226 102 74 66 77 57 81 106 128 61 106 119 13 2 65 0 210 42 162 143 204 86 93 195 255 104 97 193 149 123 10 34 162 23 215 208 76 32 204 121 249 130 196 212 24 238 168 193 189 194 194 170 49 220 129 98 105 144 58 68 246 101 68 136 248 207 144 89 91 209 132 80 102 189 2 188 8 109 178 101 2 65 0 149 2 178 174 11 60 227 165 250 139 28 68 55 30 163 194 225 114 72 240 136 251 91 227 47 107 160 143 73 40 23 233 93 22 204 245 187 172 90 131 23 57 243 66 216 71 207 96 227 127 125 231 160 126 98 182 189 166 94 174 173 146 249 153 2 65 0 128 165 64 100 173 59 160 161 188 209 116 37 63 14 213 161 101 127 26 199 146 17 241 152 40 54 247 172 172 166 73 254 109 221 173 178 232 90 133 136 107 253 176 237 77 181 167 66 0 171 109 60 133 139 182 102 80 189 25 211 103 133 94 81 2 64 37 53 142 177 76 246 190 97 27 133 66 115 12 185 138 138 130 178 246 220 96 215 227 150 230 174 0 39 27 135 207 175 54 4 142 130 139 93 21 82 134 195 186 96 192 153 144 20 48 245 88 175 38 108 143 66 68 54 6 146 129 156 66 188]}
gen org cert         >> : &{CERTIFICATE map[] [48 130 2 207 48 130 2 56 160 3 2 1 2 2 8 93 97 198 153 137 158 7 219 48 13 6 9 42 134 72 134 247 13 1 1 11 5 0 48 104 49 11 48 9 6 3 85 4 6 19 2 67 78 49 16 48 14 6 3 85 4 8 19 7 66 101 105 106 105 110 103 49 16 48 14 6 3 85 4 7 19 7 72 97 105 100 105 97 110 49 17 48 15 6 3 85 4 10 19 8 106 105 104 97 111 45 67 65 49 13 48 11 6 3 85 4 11 19 4 98 117 97 97 49 19 48 17 6 3 85 4 3 19 10 119 119 119 46 99 97 46 99 111 109 48 30 23 13 49 56 48 54 49 52 48 57 49 53 51 52 90 23 13 51 56 48 54 49 52 48 57 49 53 51 52 90 48 116 49 11 48 9 6 3 85 4 6 19 2 85 75 49 16 48 14 6 3 85 4 8 19 7 69 110 103 108 97 110 100 49 15 48 13 6 3 85 4 7 19 6 76 111 110 100 111 110 49 18 48 16 6 3 85 4 10 19 9 111 118 101 114 119 97 116 99 104 49 18 48 16 6 3 85 4 11 19 9 100 97 114 107 119 97 116 99 104 49 26 48 24 6 3 85 4 3 19 17 119 119 119 46 111 118 101 114 119 97 116 99 104 46 99 111 109 48 129 159 48 13 6 9 42 134 72 134 247 13 1 1 1 5 0 3 129 141 0 48 129 137 2 129 129 0 191 99 144 111 179 108 139 12 249 25 12 63 111 34 237 137 113 7 213 5 63 108 209 87 67 37 104 74 165 216 48 181 93 229 136 31 182 153 101 182 99 120 68 32 73 127 206 100 221 168 166 221 148 205 137 27 210 76 159 230 239 13 64 28 32 221 186 110 108 99 131 62 115 162 140 77 206 50 48 245 120 232 208 132 165 11 134 104 175 95 92 20 207 249 223 93 226 112 80 171 199 9 161 207 212 64 45 134 225 241 63 206 161 181 12 85 253 27 175 17 149 104 48 229 90 81 2 33 2 3 1 0 1 163 118 48 116 48 14 6 3 85 29 15 1 1 255 4 4 3 2 2 132 48 29 6 3 85 29 37 4 22 48 20 6 8 43 6 1 5 5 7 3 2 6 8 43 6 1 5 5 7 3 1 48 15 6 3 85 29 19 1 1 255 4 5 48 3 1 1 255 48 50 6 3 85 29 17 4 43 48 41 130 17 119 119 119 46 111 118 101 114 119 97 116 99 104 46 99 111 109 129 20 116 114 97 99 101 114 64 111 118 101 114 119 97 116 99 104 46 99 111 109 48 13 6 9 42 134 72 134 247 13 1 1 11 5 0 3 129 129 0 90 246 189 124 253 53 92 106 17 95 136 216 97 169 20 211 114 94 109 159 162 255 253 227 168 145 133 254 246 78 246 225 240 181 18 252 136 11 145 19 152 143 5 164 198 221 90 9 189 71 254 19 12 41 168 66 32 100 69 120 40 79 159 26 206 19 109 224 206 127 69 186 100 52 92 19 167 187 174 115 67 45 196 113 20 72 78 156 65 240 91 57 141 54 227 16 114 215 177 223 196 45 102 152 27 65 247 176 163 165 124 66 72 158 39 94 183 187 187 65 130 253 180 4 113 9 25 92]}
verify               >> : true <nil>
*verify*             >> : false x509: certificate signed by unknown authority

 _____   _   _   ____
| ____| | \ | | |  _ \
|  _|   |  \| | | | | |
| |___  | |\  | | |_| |
|_____| |_| \_| |____/
```